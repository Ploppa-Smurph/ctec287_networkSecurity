<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTEC 287 Comptia Security+ Lesson 03: Performing Security Assessments</title>
</head>
<body>
<pre>    
<h1>Lesson 03: Performing Security Assessments</h1>
    Security assessment - processes and tools that evaluate the attack surface
    
 Lesson Objectives:
   - Assess organizational security with network reconnaissance tools
   - Explain security concerns with general vulnerability types
   - Summarize vulnerability scanning techniques
   - Explain penetration testing concepts

  the 'Cyber Kill Chain' -- 
    - Initial Recon
    - Initial Compromise
    - Establish Foothold
    - Escalate Privileges
    - Internal Recon
    - Complete Mission

  <b>Lockheed Martin Cyber Kill Chain</b>
   1) Reconnaissance
   2) Weaponization
   3) Delivery         - of code to enable exploit
   4) Exploitation
   5) Installation
   6) Command & Control
   7) Action on Objectives

  <b>Hack / Defend Chain</b>
   - Discovery / Recon
   - Penetration / Foothold
   - Process Insertion
   - Persistence
   - Escalate Privileges
   - Internal Reconnaissance
   - Lateral Movement
   - Action on Objectives (data egress, manipulation, APT)
     
  Indicators of Attack (IoA)
  Indicators of Compromise (IoC)
<h2>03A Assess Organizational Security with Network Reconnaissance</h2>   
      Reconnaissance is an assessment activity
       -- maps potential attack surface
       -- identify nodes and connections that make up network

     passive scan == using site such as <a href="https://www.shodan.io/">'shodan.io'</a> or  'whois' or other websites to discover information
     active scan  == using tools ie: Metagoofil; 
               metagoofil downloads html, pdf, txt and other files and then extracts usernames and programs (including version information) that are on the network
                  allows hackers to determine exploits
               nmap == can be used with scripts to obtain more detailed information
                    nmap is a simple network topology scanner
               nmapfe (in zenmap) -- is a GUI frontend for using nmap
<h3>Ipconfig, Ping, and ARP</h3>
     topology scanning aka 'footprinting'
     <b>ipconfig</b> - shows configuration assigned to network interfaces in Windows
                           if the network uses DHCP, it will also point to the DHCP server IP address
     
     <b>ifconfig</b> - show configuration of network interfaces in Linux

     <b>ping</b> - probe a host on a particular IP address using ICMP (Internet Control Message Protocol)
          you can use scripting to create loops to increase the use of Ping

     <b>arp</b>  - Address Resolution Protocol (arp) - command can be used to display local machines ARP cache
                the ARP cache shows MAC address of the interfaces associated with each IP address
                  ex: sign of a man in the middle attack is that the MAC address will not match the IP address associated with the router

    ** in linux use 'iproute2' instead of arp, route, and traceroute               
<h3>Route and Traceroute</h3>
     <b>route</b> - view and configure the host's local routing table

     <b>tracert</b> - uses ICMP probes to report Round Trip Time (RTT) for hops between local and remote host
     
     <b>traceroute</b> - Linux version of the tool, uses UDP probes rather than ICMP
     
     <b>pathping</b> - Windows - provides statistics for latency and packet loss over a longer period
          <b>mtr</b> - Linux version of the tool  
    
       -- high latency at the default gateway compared to the baseline might indicate a man-in-the-middle attack 

     ** in linux use 'iproute2' instead of arp, route, and traceroute
<h3>IP Scanners and Nmap</h3>
     <b>SNMP (Simple Network Management Protocol)</b>

     <b>Nmap Security Scanner</b> - popular open source IP scanner
        Nmap pings and sends TCP ACK packet to ports 80 & 443 to determine if a host is present 
<h3>Service Discovery and Nmap</h3>
     after finding the IP addresses and Hosts on a network we discover which OSs are in use on the system, 
         which network service each host is running, and which application software is underpinning those services

     <b>TCP SYN <i>(-sS)</i></b> - fast technique (aka Half-Open Scanning)
                                  the scanning host reqests a connection and then does not acknowledge
                                  the target's response to the scan's SYN packet identifies the port state
                              
     <b>UDP scans <i>(-sU)</i></b> - does not use ACKs - nmap needs to wait and this can take a longer time.
                                   CAN be combined with TCP scan
                                   
     <b>Port Range <i>(-p)</i></b> - by default nmap scans 1000 commonly used ports as listed in configuration file
                                        <i>-p</i> arguement is used to scan specific port ranges                               

     <b>fingerprinting</b> - detailed analysis of services on a particular host 
                 aka 'banner grabbing'

     when sercvices are discovered you can use Nmap with <i>-sV</i> or <i>-A</i> switch to probe a host more intensively
        you can discover: 
          - Protocol - scans and lists what protocols are being used at which port
          - Application Name and Version - ex: Apache Web Server or Windows IIS
          - OS type and Version - use the <i>-o</i> to get the OS,
               (or <i>-A</i> for both OS and version)            
          - Device Type - identifies devices as routers, switches, NAS boxes, printers, webcams, etc..     
<h3>Netstat and Nslookup</h3>
     <b>netstat</b> - shows state of TCP/UDP ports on local machine; can see service misconfigurations
        can alsow be used to identify suspect remote connections to services on local host

        <b><i>netstat -ano</i></b>  -- very helpful when trying to identify malware.
            <i>-a</i> display active TCP and UDP connections, plus open (listening) TCP connections
            <i>-n</i> suppress name resolution, host IP address and ports are shown in output
            <i>-o</i> shows PID (Process ID) of application or service that has port opened

     <b>nslookup / dig</b> - query name records for a given domain
         misconfigured DNS service may allow a 'zone transfer' which will give an attacker complete records of every host in the domain
     
         'nslookup' works for both Windows and Linux; 'dig' is used in Linux
<h3>Other Reconnaissance and Discovery Tools</h3>
    <b>the Harvester</b> - scanns domain or company for public data, including email, names, subdomains, IPs, URLs and more
                    <a href="https://github.com/laramies/theHarvester">link to github 'the Harvester'</a>
    
    <b>dnsenum</b> - packages 'dig', 'whois' and more host identification tools into 1
            ** not updated since 2015 <a href="https://github.com/fwaeytens/dnsenum">link to github 'dnsenum'</a>                     

    <b>scanless</b> - uses 3rd party sites to disguise IP that port scans are coming from
                    <a href="https://github.com/vesche/scanless">link to github 'Scanless'</a>       

    <b>curl</b> - used for performing data transfer and supports many protocols
    
    <b>Nessus</b> - commercial vulnerability scanner, pulls list of services and version information from the host
                     free to use on small home networks, or available as a local (Nessus Manager) or cloud (Tenable Cloud) versions.  
<h3>Packet Capture and TCPdump</h3>
     <b>Packet Analysis</b> - deep frame-by-frame scrutiny of capture frames

     <b>Protocol Analysis</b> - using statistical tools to analyze a sequence of packets 

     <b>tcpdump</b> - command line packet capture tool in Linux. 
               often used with filter expressions to reduce number of frames captured: 
<h3>Packet Analysis and Wireshark</h3>
     <b>traffic analysis</b> - protocol / packet analyzer working with a sniffer to view data flow across network

     <b>wireshark</b> - open-source graphical packet capture and analysis utility 
        various tools are built into wireshare: 
           <b><i>I/O graph</i></b> - 
<h3>Packet Injection and Replay</h3>
       Ettercap, Scapy, and hping

     <b>hping</b> - open source spoofing tool that provides pen tester with ability to craft network packets to exploit vulnerable firewalls and IDSs
          hping performs following tests:
          <i>Host/Port detection and firewall testing</i> - used to probe IP addresses and TCP/UDP ports for responses

          <i>Traceroute</i> - if ICMP is blocked on local network, hping offers alternate way of mapping out network routes

          <i>Denial of Service (DoS)</i> - hping can perform flood-based DoS attacks from randomized source IPs 

     <b>tcpreplay</b> - takes previously captured network traffic (saved as .pcap) and reeplays it through a network interface      
<h3>Exploitation Frameworks</h3>
     <b>Remote Access Trojan (RAT)</b> - malware that give advesary means of remotely accessing network

     <b>expolitation framework</b> - uses vulnerabilities identified by automated scanners and launches scripts to attempt to deliver matching exploits
          <b><i>CVE - Common Vulnerability and Exposure</i></b>
     
     <b>Metasploit</b> - most well known exploit framework, can be used closesly with <b><i>Nexpose</i></b> vulnerability scanner

     <b>Sn1per</b> - framework designed for pentesting and evidence gathering. 
            Sn1per can integrate with Metasploit and Nikto to run autotmated suites of tests

     <b>fireELF</b> - injecting fileless exploit for Linux host

     <b>RouterSploit</b> - vulnerability scanning and exploit modules

     <b>Browser Exploitation Framework (BeEF)</b> - recovering web session information and exploiting client side script

     <b>Zed Attack Proxy (ZAP)</b> - scanning tools and scripts for web app and mobile app security testing
     
     <b>Pacu</b> - scanning and exploit tool for AWS (Amazon Web Service)
<h3>Netcat</h3>
     tool used to test network connectivity. netcat can write raw data over a connection

     <b><i>echo "head" | nc 10.1.0.1 -v 80</i></b> this command attempts to connect to the HTTP port (80) and send the banner 'head' keyword

  netcat can be configured as a backdoor:
    - on the victim machine set up a 'listener': 
       <b><i>nc -l -p 666 -e cmd.exe</i></b>

    - the 'listener' grants access when this command is run:
       <b><i>nc 10.1.0.1 666</i></b>  

<h2>03B Explain Security Concerns with General Vulnerability Types</h2>    
<h3>Software Vulnerabilities and Patch Management</h3>
     <b>Operating System (OS)</b> - application exploit that could allow privilege escalation
          ex: 'Dirty COW' can exploit the Linux kernel

     <b>Firmware</b> - vulnerabilities in the BIOS/UEFI that controls boot process, or device firmware bugs.
            Internet of Things (IoT) run OS code as a type of firmware.
          ex: Intel AMT vulnerability
<h3>Zero-Day and Legacy Platform Vulnerabilities</h3>
     <b>Zero-Day</b> - exploit that is exposed before a vendor has a chance to patch it

     <b>Legacy Platfor</b> - older system that is no longer patchable (vendor no longer maintains / updates code)
        must be isolated from the rest of the network in order to secure, because the vendor is no longer patching the software
<h3>Weak Host Configurations</h3>
     <b>Default Settings</b> - deploying a device using only default settings is weak

     <b>Unsecured Root Account</b> - adversaries can gain control of Administrator/Super User acount and wreak havok
            effective user management and authorization policies must be enforced

     <b>Open Permissions</b> - provisioning data without differentiating access rights for user groups. 
<h3>Weak Network Configurations</h3>
    vulnerabiltiy can arise from running unnecessary services or using weak encryption
     <b>Open Ports and Services</b> - running unnecessary services or having open ports increases the 'Attack Surface' of the network
       - restrict endpoint access allowed by service 
       - disable services installed by default, but not needed
       - services that should be available on the private network should have access blocked at ports on the border firewall 

     <b>Unsecure Protocols</b> - unsecured protocols transmit data as 'plaintext'

     <b>Weak Encryption</b> - can allow unauthorized access to data
       - simple passwords can lead to brute-force enumeration, or dictionary enumeration
       - if weak encryption is used then a program can brute-force the enumeration 
       - if the key falls into the hands of an unauthorized user

     <b>Errors</b> - error messages can be revealing and can tell threat actors more about how to exploit the network
<h3>Impacts from Vulnerabilities</h3>
     <b>Data Breaches and Data Exfiltration Impacts</b> - 
          - Data Breach -  event where confidential data is read, transferred, modified, or deleted without authorization.
                can be accidental or intentional

          - Data Exfiltration - ALWAYS Malicious -- data is breached and then transferred to an external network or media
     
     <b>Identity Theft Impacts</b> - privacy breach where threat actor is able to use personal details for fraudulant activity

     <b>Data Loss and Availability Loss Impacts</b> - data becomes unavailable, either permenantly or temporarily
          this affects the Availabilty of the CIA Triad -- can have a severe impact on business work flow

     <b>Financial and Reputation Impacts</b> - breaches cause damage to businesses' reputation and can result in fines, financial damage, and loss of business
<h3>Third-Party Risks</h3>
     <b>Vendor Management</b>

     <b>Outsourced Code Development</b>

     <b>Data Storage</b>
          - 
          - 
          - 

     <b>Cloud-based vs On-premises Risks</b>

<h2>03C Summarize Vulnerability Scanning Techniques</h2>    
<h3>Security Assessments</h3>
<h3>Vulnerability Scan Types</h3>
<h3>Common Vulnerabilities and Exposures</h3>
<h3>Intrusive vs Non-intrusive Scanning</h3>
<h3>Credentialed vs Non-credentialed Scanning</h3>
<h3>False Positives, False Negatives, and Log Review</h3>
<h3>Configuration Review</h3>
<h3>Threat Hunting</h3>

<h2>03D Explain Penetration Testing Concepts</h2>    
<h3>Penetration Testing</h3>
<h3>Rules of Engagement</h3>
<h3>Exercise Types</h3>
<h3>Passive and Active Reconnaissance</h3>
<h3>Pen Test Attack Life Cycle</h3>
</pre>    
</body>
</html>